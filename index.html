<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Table Tennis - Daniel's Challenge</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            background-color: #282828;
            color: white;
        }
        canvas {
            border: 2px solid white;
        }
        #winMessage, #loseMessage {
            display: none;
            color: #4CAF50;
            font-size: 24px;
        }
        #danielFace {
            display: none;
            width: 150px;
            margin-top: 10px;
        }
        #tauntBox {
            color: #f0a;
            font-style: italic;
            margin-top: 10px;
        }
        #instructions {
            font-size: 20px;
        }
    </style>
</head>
<body>

<h1>Welcome to the Table Tennis Challenge!</h1>
<p id="instructions">Use W/S or ↑/↓ to control your paddle. Press Spacebar to smash after 2 hits.</p>

<canvas id="gameCanvas" width="600" height="400"></canvas>

<div id="tauntBox"></div>

<div id="winMessage">You got lucky this time!</div>
<div id="loseMessage">Daniel wins this time! Better luck next time!</div>
<img id="danielFace" src="https://path/to/daniel_face_image.jpg" alt="Daniel" />

<script>
// Game constants
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");

const paddleHeight = 100;
const paddleWidth = 10;
const WINNING_SCORE = 11;
let playerScore = 0;
let aiScore = 0;

let playerY = canvas.height / 2 - paddleHeight / 2;
let aiY = canvas.height / 2 - paddleHeight / 2;
let ballX = canvas.width / 2;
let ballY = canvas.height / 2;
let ballSpeedX = 5;
let ballSpeedY = 3;

let keys = {};
let hitCount = 0;
let canSmash = false;
let tauntCooldown = 0;

const taunts = [
    "Nice try!",
    "That all you got?",
    "You're not even sweating.",
    "I've beaten tougher opponents blindfolded.",
    "Almost impressive!",
    "This is my warmup."
];

// Update the game state
function update() {
    // Keyboard control
    if (keys['w'] || keys['ArrowUp']) playerY -= 6;
    if (keys['s'] || keys['ArrowDown']) playerY += 6;

    // Clamp player position
    playerY = Math.max(0, Math.min(canvas.height - paddleHeight, playerY));

    ballX += ballSpeedX;
    ballY += ballSpeedY;

    if (ballY <= 0 || ballY >= canvas.height) {
        ballSpeedY = -ballSpeedY;
    }

    // Player paddle collision
    if (ballX < paddleWidth && ballY > playerY && ballY < playerY + paddleHeight) {
        ballSpeedX = -ballSpeedX;
        hitCount++;
        if (hitCount >= 2) {
            canSmash = true;
        }
    }

    // AI paddle collision
    if (ballX > canvas.width - paddleWidth &&
        ballY > aiY && ballY < aiY + paddleHeight) {
        ballSpeedX = -ballSpeedX;
        hitCount = 0; // reset hit count if AI hits it
        canSmash = false;
    }

    // Missed shots
    if (ballX < 0) {
        aiScore++;
        resetBall();
        hitCount = 0;
        canSmash = false;
    }

    if (ballX > canvas.width) {
        playerScore++;
        resetBall();
        hitCount = 0;
        canSmash = false;
    }

    // AI movement
    let aiCenter = aiY + paddleHeight / 2;
    if (aiCenter < ballY - 35) aiY += 5;
    else if (aiCenter > ballY + 35) aiY -= 5;

    // Check win/loss
    if (playerScore >= WINNING_SCORE) {
        document.getElementById("winMessage").style.display = "block";
        clearInterval(gameInterval);
    }

    if (aiScore >= WINNING_SCORE) {
        document.getElementById("loseMessage").style.display = "block";
        document.getElementById("danielFace").style.display = "block";
        clearInterval(gameInterval);
    }

    // Trigger taunt occasionally
    if (tauntCooldown <= 0 && Math.random() < 0.005) {
        const taunt = taunts[Math.floor(Math.random() * taunts.length)];
        showTaunt(taunt);
        tauntCooldown = 300; // 5 seconds cooldown
    } else {
        tauntCooldown--;
    }

    // Smash ready display
    if (canSmash) {
        showTaunt("Smash Ready! Press Spacebar.");
    }
}

// Reset the ball to center
function resetBall() {
    ballX = canvas.width / 2;
    ballY = canvas.height / 2;
    ballSpeedX = Math.random() < 0.5 ? 5 : -5;
    ballSpeedY = Math.random() * 4 - 2;
}

// Event listener for key presses
window.addEventListener('keydown', e => {
    keys[e.key.toLowerCase()] = true;

    if (e.code === "Space" && canSmash) {
        ballSpeedX = ballSpeedX > 0 ? 10 : -10;
        ballSpeedY = ballSpeedY > 0 ? 6 : -6;
        canSmash = false;
        hitCount = 0;
        showTaunt("Whoa! That was a smash.");
    }
});

// Event listener for key releases
window.addEventListener('keyup', e => {
    keys[e.key.toLowerCase()] = false;
});

// Show taunt message
function showTaunt(text) {
    const tauntBox = document.getElementById('tauntBox');
    tauntBox.textContent = "Daniel: " + text;
    setTimeout(() => tauntBox.textContent = '', 3000);
}

// Game loop
const gameInterval = setInterval(update, 1000 / 60);

</script>
</body>
</html>
